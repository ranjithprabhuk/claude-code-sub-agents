# Brinqa Vulnerability Manager Agent

A Claude sub-agent that assesses security vulnerabilities reported in the Brinqa system and determines the appropriate remediation action.

## Overview

This agent analyzes vulnerabilities from penetration tests and code scanning (SkiShield) reported in the Brinqa system. It evaluates the codebase impact and recommends one of the following actions:

1. **Fix Immediately** - Apply the fix if it's available and has minimal impact
2. **Risk Exception** - Request exception if fix causes major impact requiring extensive testing
3. **Vulnerability Not Actionable** - Mark as not exploitable if the vulnerability isn't actionable in the codebase
4. **Risk Acceptance** - Accept the risk if severity is low and impact is unlikely

## Supported Vulnerability Sources

- **SkiShield** - Code scanning findings (SCA vulnerabilities)
- **Penetration Testing** - Manual security assessment findings

## How It Works

1. **Receive Vulnerability Data** - User provides vulnerability details from Brinqa
2. **Analyze Codebase** - Agent searches for affected components and dependencies
3. **Assess Impact** - Evaluates the scope and risk of the vulnerability
4. **Determine Action** - Decides on the appropriate remediation path
5. **Execute or Document** - Either applies fixes or generates exception/acceptance requests

## Decision Flow

```
Vulnerability Input
    ↓
Analyze Codebase Impact
    ↓
    ├─ Fix Available & Low Impact → Apply Fix
    ├─ Fix Available & High Impact → Risk Exception
    ├─ Fix Not Available & Not Exploitable → Vulnerability Not Actionable
    └─ Fix Not Available & Low Severity → Risk Acceptance
```

## Usage

Provide the agent with vulnerability details from Brinqa, including:

- **Description** - What the vulnerability is
- **Meta Data** - Library name, version, CVE, CWE, file paths
- **Recommendation** - Suggested remediation
- **Deep Links** - Links to vulnerability databases
- **Reference URLs** - Additional context

The agent will analyze your codebase and either apply fixes or generate the appropriate request documents.

## Output Documents

### Risk Exception Request
Generated when fix causes major impact requiring extensive testing.

### Vulnerability Not Actionable Request
Generated when the vulnerability is not exploitable in the current codebase.

### Risk Acceptance Request
Generated when severity is low and impact is unlikely.

## Example

```
User: I have a SkiShield finding:
CVE-2025-1647 in Bootstrap 3.4.1 - XSS vulnerability
File: app/client/package.json
Recommendation: Upgrade to bootstrap-4.3.1

Agent: Let me analyze the codebase for Bootstrap usage...
[Analysis happens]
Found Bootstrap 3.4.1 in app/client/package.json
Checking for breaking changes in Bootstrap 4.3.1...
This is a major version upgrade that will require significant testing.
Generating Risk Exception Request...
```

## Requirements

- Access to the codebase being analyzed
- Vulnerability details from Brinqa system
- Understanding of the application architecture (for impact assessment)
